%能运行的
clear;
close all;
clc;
%% 音乐播放部分
fs=48000; %音乐扫描频率
dt=1/fs; %播放速度
f0=320;%音乐调高
T16=0.4;%十六分音符时长
t16=0:dt:T16;
m=size(t16,2);
t1=linspace(0,16*T16,16*m);% 全音符时长
t4_3=linspace(0,12*T16,12*m);% 附点二分音符时长
t2=linspace(0,8*T16,8*m);% 二分音符时长
t8_3=linspace(0,6*T16,6*m);% 附点四分音符时长
t4=linspace(0,4*T16,4*m);% 四分音符时长
t16_3=linspace(0,3*T16,3*m);% 附点八分音符时长
t8=linspace(0,2*T16,2*m);% 八分音符时长
% 定义音阶强度

index={'1';'4_3';'2';'8_3';'4';'16_3';'8';'16'};% 音符   全音符 附点二分音符 二分音符 附点四分音符 四分音符 附点八分音符 八分音符 十六分音符
for n=1:8
    str=['mod',char(index(n)),' = sin(pi*t',char(index(n)),...
        '/t',char(index(n)),'(end));'];
    eval(str);
end
ScaleTable = [1/2 9/16 5/8 2/3 3/4 5/6 15/16 ...
    1 9/8 5/4 4/3 3/2 5/3 9/5 15/8 ...
    2 9/4 5/2 8/3 3 10/3 15/4 4];
txt={'do','re','mi','fa','so','la','xi'};% 音符数组do re mi fa so la xi
nstr={'0','1','2'};% 强度字符串，0为低音，1为正常音，2为高音
mstr={'o','T','t','F','f','E','e','s'}; % 音符字符串o T t F f E e s
for nn=1:8
    for jj=1:3
        for ii=1:7
            mm=7*(jj - 1) + ii;
            str=[char(txt(ii)),char(nstr(jj)),char(mstr(nn)),...
                ' = mod',char(index(nn)),...
                '.*cos(2*pi*ScaleTable(',num2str(mm),')*f0*t',...
                char(index(nn)),');'];
            eval(str);
        end
    end
end                          % 各分音符的数组

o = zeros(1,size(t1,2));% 字符o(one)，全音符
T = zeros(1,size(t4_3,2));% 字符T(Two)，附点二分音符
t = zeros(1,size(t2,2));% 字符t(two)，二分音符
F = zeros(1,size(t8_3,2));% 字符F(Four)，附点四分音符
f = zeros(1,size(t4,2));% 字符f(four)，四分音符
E = zeros(1,size(t16_3,2));% 字符E(Eight)，附点八分音符
e = zeros(1,size(t8,2));% 字符e(eight)，八分音符
s = zeros(1,size(t16,2));% 字符s(sixteen)，十六分音符
% 音符名称对应英文首字母，大写表示加附点

yuepu = [la1e la1s la1s do2e re2s la1s...% 江楼上独凭栏，听钟鼓声传
    so1f so1E la1s...
    so1e so1e la1e do2s re2s...
    mi1t...
    mi1e re1s mi1s so1e mi1s so1s...% 袅袅娜娜散入那落霞斑斓，一江春水缓缓流
    la1E do2s re2E mi2s...
    do2e re2s mi2s re2s do2s la1e...
    so1f so1E do2s...
    la1s do2s re2e la1s do2s so1s re1s...
    mi1t...
    mi1e la1s do2s so1s la1s so1s mi1s...%四野俏无人
    re1t...
    mi1E so1s la1s so1s la1s do1s...% 唯有渐渐袭来淡淡的薄雾轻烟
    re1e mi1s re1s do1s re1s mi1s do1s...
    re1o...
    mi2s re2F...% 看，月上东山，天宇云开雾散
    re2e re2e mi2s so2s mi2s re2s...
    do2f do2s re2s la1s so1s...
    do2E mi2s re2E mi2s...
    re2E mi2s re2e re2e...% 云开雾散
    re2s mi2s so2e mi2s so2s mi2s re2s...% 光辉照山川，千点万点，千点万点洒在江面，恰似银鳞闪闪，惊起了江滩一只宿雁
    do2E mi2s re2E mi2s...
    do2E mi2s re2E mi2s...
    do2e re2s mi2s re2s do2s la1e...
    so1f so1E la1s...
    mi1E so1s la1e do2e...
    so1f so1e do2s re2s...
    la1E do2s so1e fa1e...
    mi1E re1s do1e mi1e...
    re1t...
    mi1e la1s do2s so1s la1s so1s mi1s...% 扑楞楞飞过了对面的杨柳岸
    re1e mi1s re1s do1s re1s mi1s do1s...
    re1t...
    mi2T mi2s so2s mi2s re2s...% 听，清风吹来
    re2f re2f...
    mi1f la1E do2s...% 竹枝儿摇，摇得花影零乱
    so1f so1E do1s...
    la1s do2s re2e la1s do2s so1s re1s...
    mi1t...
    mi1e la1s do2s so1s la1s so1s mi1s...% 幽香飘散
    re1t...
    re1s mi1s so1e mi1s so1s mi1s re1s...% 何人吹弄笛声箫声笛声箫声
    do2E mi2s re2E mi2s...
    do2E mi2s re2E mi2s...
    do2e so1e la1e do2e...% 和着歌声
    re2t...
    re2s mi2s so2e mi2s so2s mi2s re2s...% 自在悠然
    do2t...
    do2e do2e do2e re2s mi2s...% 矣乃韵远
    la1t...
    la1e la1e do2e so1e...% 飘向那水云深处
    mi1E mi1s mi1e so1e...
    mi1E mi1s mi1e so1e...% 芦苇岸边
    la1E do2s re2E mi2s...% 唯有渔火点点，伴着人儿安眠
    do2e re2s mi2s re2s do2s la1e...
    so1f so1E la1s...
    so1e so1e la1e so2s re2s...
    mi1t...
    mi1e la1s do2s so1s la1s so1s mi1s...% 春江花月夜，怎不叫人流连
    re1e mi1s re1s do1s re1s mi1s do1s...
    re1o];% 音乐乐谱（yuepu数组内变量的命名规则：“音阶+强度+音符”形式）
%若有休止符号，直接写音符
yuepu = yuepu/max(yuepu);

sound(yuepu,fs);%调用函数播放音乐




